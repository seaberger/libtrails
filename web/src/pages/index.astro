---
import BaseLayout from '../layouts/BaseLayout.astro';
import ThemeCard from '../components/ThemeCard.astro';
import ThemeSearch from '../components/ThemeSearch.astro';
import { getThemes } from '../lib/api';

// Fetch themes at build time (SSR) or request time
const themes = await getThemes(200, 3);
---

<BaseLayout title="Themes" description="Browse your book library by themes and topics">
  <header class="mb-6">
    <h1 class="text-2xl font-medium text-[var(--color-text)] mb-2">
      Themes
    </h1>
    <p class="text-[var(--color-text-muted)]">
      Discover connections across {themes.length} topic clusters from your library
    </p>
  </header>

  <ThemeSearch />

  <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4" data-themes-grid>
    {themes.map(theme => (
      <ThemeCard theme={theme} />
    ))}
  </div>
</BaseLayout>
